name: Daily AI Briefing

on:
  schedule:
    # cron 语法：分 时 日 月 周
    # GitHub 使用 UTC 时间。
    # 北京时间 08:00 = UTC 00:00
    - cron: '0 0 * * *' 
  
  # 允许手动点击 "Run workflow" 按钮来测试
  workflow_dispatch:

jobs:
  send_briefing:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code (下载代码)
      uses: actions/checkout@v3

    - name: Set up Python (安装 Python)
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: Install dependencies (安装依赖)
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Run script
      env:
        DEEPSEEK_API_KEY: ${{ secrets.DEEPSEEK_API_KEY }}  # 这里改了
        EMAIL_SENDER: ${{ secrets.EMAIL_SENDER }}
        EMAIL_APP_PASSWORD: ${{ secrets.EMAIL_APP_PASSWORD }}
        EMAIL_RECEIVER: ${{ secrets.EMAIL_RECEIVER }}
      run: python daily_briefing_rss.py